import { visit } from "unist-util-visit";
import slugger from "github-slugger";
function createCollectHeaders() {
  const headers = [];
  function rehypeCollectHeaders() {
    return function(tree) {
      visit(tree, (node) => {
        var _a;
        if (node.type !== "element")
          return;
        const { tagName } = node;
        if (tagName[0] !== "h")
          return;
        const [_, level] = tagName.match(/h([0-6])/) ?? [];
        if (!level)
          return;
        const depth = Number.parseInt(level);
        let text = "";
        visit(node, "text", (child) => {
          text += child.value;
        });
        let slug = ((_a = node == null ? void 0 : node.properties) == null ? void 0 : _a.id) || slugger.slug(text);
        node.properties = node.properties || {};
        node.properties.id = slug;
        headers.push({ depth, slug, text });
      });
    };
  }
  return {
    headers,
    rehypeCollectHeaders
  };
}
export {
  createCollectHeaders as default
};
